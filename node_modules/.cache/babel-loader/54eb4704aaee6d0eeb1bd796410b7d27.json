{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/1/Desktop/Start/samurai/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/1/Desktop/Start/samurai/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\1\\\\Desktop\\\\Start\\\\samurai\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{authAPI}from\"../API/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='SET_USER_DATA';var initialState={email:null,id:null,login:null,isAuth:false};var loginReducer=function loginReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:{return _objectSpread(_objectSpread({},state),action.payload);}default:return state;}};export var setUserData=function setUserData(email,id,login,isAuth){return{type:SET_USER_DATA,payload:{email:email,id:id,login:login,isAuth:isAuth}};};export var getAuth=function getAuth(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,email,id,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.authMe();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,email=_response$data$data.email,id=_response$data$data.id,_login=_response$data$data.login;dispatch(setUserData(email,id,_login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuth());}else{message=response.data.messages.length>0?response.data.messages[0]:\"Some error\";dispatch(stopSubmit('login',{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default loginReducer;","map":{"version":3,"sources":["C:/Users/1/Desktop/Start/samurai/src/Redux/login-reducer.js"],"names":["authAPI","stopSubmit","SET_USER_DATA","initialState","email","id","login","isAuth","loginReducer","state","action","type","payload","setUserData","getAuth","dispatch","authMe","response","data","resultCode","password","rememberMe","message","messages","length","_error","logout"],"mappings":"8WAAA,OAAQA,OAAR,KAAsB,YAAtB,CACA,OAAQC,UAAR,KAAyB,YAAzB,CAEA,GAAMC,CAAAA,aAAa,CAAG,eAAtB,CAEA,GAAIC,CAAAA,YAAY,CAAG,CACfC,KAAK,CAAE,IADQ,CAEfC,EAAE,CAAE,IAFW,CAGfC,KAAK,CAAE,IAHQ,CAIfC,MAAM,CAAE,KAJO,CAAnB,CAUA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CACnD,OAAQA,MAAM,CAACC,IAAf,EACI,IAAKT,CAAAA,aAAL,CAAoB,CAChB,sCACOO,KADP,EAEOC,MAAM,CAACE,OAFd,EAIH,CACD,QACI,MAAOH,CAAAA,KAAP,CARR,CAUH,CAXD,CAaA,MAAO,IAAMI,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACT,KAAD,CAAQC,EAAR,CAAYC,KAAZ,CAAmBC,MAAnB,QAA+B,CAACI,IAAI,CAAET,aAAP,CAAsBU,OAAO,CAAE,CAACR,KAAK,CAALA,KAAD,CAAQC,EAAE,CAAFA,EAAR,CAAYC,KAAK,CAALA,KAAZ,CAAmBC,MAAM,CAANA,MAAnB,CAA/B,CAA/B,EAApB,CAEP,MAAO,IAAMO,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,kGAAM,iBAAOC,QAAP,yLACDf,CAAAA,OAAO,CAACgB,MAAR,EADC,QAClBC,QADkB,eAEjB,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAmC,qBACNF,QAAQ,CAACC,IAAT,CAAcA,IADR,CAC1Bd,KAD0B,qBAC1BA,KAD0B,CACnBC,EADmB,qBACnBA,EADmB,CACfC,MADe,qBACfA,KADe,CAE/BS,QAAQ,CAACF,WAAW,CAACT,KAAD,CAAQC,EAAR,CAAYC,MAAZ,CAAmB,IAAnB,CAAZ,CAAR,CACH,CALgB,sDAAN,gEAAhB,CAQP,MAAO,IAAMA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACF,KAAD,CAAQgB,QAAR,CAAkBC,UAAlB,kGACjB,kBAAON,QAAP,kKACyBf,CAAAA,OAAO,CAACM,KAAR,CAAcF,KAAd,CAAqBgB,QAArB,CAA+BC,UAA/B,CADzB,QACQJ,QADR,gBAEQ,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAmC,CAC/BJ,QAAQ,CAACD,OAAO,EAAR,CAAR,CACH,CAFD,IAEO,CACCQ,OADD,CACWL,QAAQ,CAACC,IAAT,CAAcK,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCP,QAAQ,CAACC,IAAT,CAAcK,QAAd,CAAuB,CAAvB,CAApC,CAAgE,YAD3E,CAEHR,QAAQ,CAACd,UAAU,CAAC,OAAD,CAAU,CAACwB,MAAM,CAAEH,OAAT,CAAV,CAAX,CAAR,CACH,CAPT,wDADiB,kEAAd,CAaP,MAAO,IAAMI,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,mGAClB,kBAAOX,QAAP,0JACyBf,CAAAA,OAAO,CAAC0B,MAAR,EADzB,QACQT,QADR,gBAEQ,GAAIA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAjC,CAAmC,CAC/BJ,QAAQ,CAACF,WAAW,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAZ,CAAR,CACH,CAJT,wDADkB,kEAAf,CASP,cAAeL,CAAAA,YAAf","sourcesContent":["import {authAPI} from \"../API/api\";\r\nimport {stopSubmit} from \"redux-form\";\r\n\r\nconst SET_USER_DATA = 'SET_USER_DATA'\r\n\r\nlet initialState = {\r\n    email: null,\r\n    id: null,\r\n    login: null,\r\n    isAuth: false\r\n\r\n\r\n}\r\n\r\n\r\nconst loginReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_USER_DATA: {\r\n            return {\r\n                ...state,\r\n                ...action.payload\r\n            }\r\n        }\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport const setUserData = (email, id, login, isAuth) => ({type: SET_USER_DATA, payload: {email, id, login, isAuth}})\r\n\r\nexport const getAuth = () => async (dispatch) => {\r\n       let response = await authAPI.authMe()\r\n            if (response.data.resultCode === 0){\r\n                let {email, id, login} = response.data.data\r\n                dispatch(setUserData(email, id, login, true))\r\n            }\r\n    }\r\n\r\nexport const login = (email, password, rememberMe) =>\r\n    async (dispatch) =>{\r\n        let response = await authAPI.login(email, password, rememberMe)\r\n            if (response.data.resultCode === 0){\r\n                dispatch(getAuth())\r\n            } else {\r\n                let message = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\"\r\n                dispatch(stopSubmit('login', {_error: message}))\r\n            }\r\n    }\r\n\r\n\r\n\r\nexport const logout = () =>\r\n    async (dispatch) =>{\r\n        let response = await authAPI.logout()\r\n            if (response.data.resultCode === 0){\r\n                dispatch(setUserData(null, null, null, false))\r\n            }\r\n    }\r\n\r\n\r\nexport default loginReducer;\r\n"]},"metadata":{},"sourceType":"module"}